<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Appel HTTP avec fetch()
    </title>
    <script>
        // async function fetchUsers() {
        //     // const r = await fetch('https://jsonplaceholder.typicode.com/users', {
        //     //     method: 'GET',
        //     //     headers: {
        //     //         "Accept": "application/json" // What i intend to receive
        //     //     }
        //     // })
        //     const r = await fetch('https://jsonplaceholder.typicode.com/posts', {
        //         method: 'POST',
        //         headers: {
        //             "Accept": "application/json", // What i intend to receive
        //             "Content-Type": "application/json" // What the server is waiting to receive
        //         },
        //         body: JSON.stringify({title: 'Mon premier titre'})
        //     })
        //     console.log(r.headers.get('Content-Type'))
        //     if (r.ok === true) {
        //         return r.json()
        //     }
        //     throw new Error('Impossible de contacter le serveur')
        // }
        //
        // fetchUsers().then(users => console.log(users))


        const a = new AbortController()
        Promise.race([
            fetch('https://jsonplaceholder.typicode.com/posts/?_limit=5&_delay=2000',
                {signal: a.signal}),
            fetch('https://jsonplaceholder.typicode.com/users/?_limit=3', {signal: a.signal})
        ]).then(r => r.json()).then(body => {
            a.abort()
            console.log(body)
        })

    </script>
</head>
<body>

</body>
</html>